<%= link_to "Retour aux solutions", planning_compute_solutions_path(@planning), { :class=>"btn-success" } %>

<div class="row">
  <div class="col-xs-6">
    <h3> <b>Number of possibilities - theory : </b><%= @compute_solution.nb_possibilities_theory %></h2>
    <% if @compute_solution.nb_iterations.nil? %>
      <h3>Number of iterations, number of cuts within tree, %tree covered ==> <b>Unable to calculate</b></h3>
    <% else %>
      <h3>Number of iterations : <%= @compute_solution.nb_iterations %></h3>
      <h3>Number of cuts within tree : <%= @compute_solution.nb_cuts_within_tree %></h3>
      <h3>%tree covered : <%= number_to_percentage((@compute_solution.nb_iterations.to_f / @compute_solution.nb_possibilities_theory)*100, precision: 2) %></h3>
    <% end %>
  </div>

  <div class="col-xs-6">
    <div id="chart"></div>
  </div>
  <div class="col-xs-12">
    <div id="table_div"></div>
  </div>

<%= javascript_include_tag "dataviz/calculation_details" %>
<%= content_for(:after_js) do %>

  <script>
    var t1 = <%= @timestamps_length[0] if @timestamps.length.positive? %>;
    var t2 = <%= @timestamps_length[1] if @timestamps.length > 1 %>;
    var t3 = <%= @timestamps_length[2] if @timestamps.length > 2%>;
    var t4 = <%= @timestamps_length[3] if @timestamps.length > 3%>;
    var t5 = <%= @timestamps_length[4] if @timestamps.length > 4 %>;
    var t6 = <%= @timestamps_length[5] if @timestamps.length > 5 %>;
    var t7 = <%= @timestamps_length[6] if @timestamps.length > 6 %>;
    var row1 = ['create ComputeSolution', '' , "<%= @timestamps_details[0][0] %>", 0, 0, 0];
    var row2 = ['start CreateSlotgroupsService','ComputeSolution creation', "<%= @timestamps_details[1][0]%>", <%= @timestamps_details[1][1] %>,<%= @timestamps_details[1][2] %>, <%=  @timestamps_details[1][3]%> ];
    var row3 = ['end CreateSlotgroupsService', 'Initialisation algo', "<%= @timestamps_details[2][0]%>", <%= @timestamps_details[2][1] %>,<%= @timestamps_details[2][2] %>, <%=  @timestamps_details[2][3]%> ];
    var row4 = ['start GoFindSolutionsService', 'Choix algo yes/no', "<%= @timestamps_details[3][0]%>", <%= @timestamps_details[3][1] %>,<%= @timestamps_details[3][2] %>, <%=  @timestamps_details[3][3]%> ];
    var row5 = ['start pick_best_solution', 'Balayage Arbre', "<%= @timestamps_details[4][0]%>", <%= @timestamps_details[4][1] %>,<%= @timestamps_details[4][2] %>, <%=  @timestamps_details[4][3]%> ];
    var row6 = ['start SaveSolutionsAndSolutionSlotsService', 'Tri des solutions', "<%= @timestamps_details[5][0]%>", <%= @timestamps_details[5][1] %>,<%= @timestamps_details[5][2] %>, <%=  @timestamps_details[5][3]%> ];
    var row7 = ['end SaveSolutionsAndSolutionSlotsService', 'Stockage solutions', "<%= @timestamps_details[6][0]%>", <%= @timestamps_details[6][1] %>,<%= @timestamps_details[6][2] %>, <%=  @timestamps_details[6][3]%> ];

  </script>
<% end %>
